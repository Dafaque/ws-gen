// Code generated by wsgen. DO NOT EDIT.
package api
import (
    "time"
    
    "{{get_param "module"}}/{{get_param "package"}}/iface"
    "{{get_param "module"}}/{{get_param "package"}}/model"
    
    "github.com/gorilla/websocket" 
)

type MessageSender struct {
    conn *websocket.Conn
    coder iface.Coder
}

func NewMessageSender(conn *websocket.Conn, coder iface.Coder) *MessageSender {
    return &MessageSender{conn: conn, coder: coder}
}

func (c *MessageSender) SendBinary(data []byte) error {
    return c.conn.WriteMessage(websocket.BinaryMessage, data)
}

func (c *MessageSender) send(msg interface{}) error {
    data, err := c.coder.Marshal(msg)
    if err != nil {
        return err
    }
    return c.SendBinary(data)
}

func (c *MessageSender) Ping() error {
    return c.conn.WriteControl(
        websocket.PingMessage,
        nil,//@todo
        time.Now().Add(5*time.Second),//@todo
    )
}
func (c *MessageSender) Pong() error {
    return c.conn.WriteControl(
        websocket.PongMessage,
        nil,//@todo
        time.Now().Add(5*time.Second),//@todo
    )
}

{{- range $msg := .Messages}}
{{- $name := sconv $msg.Name}}
// Sends {{$name}} message
// To instance {{$name}} message use model.New{{$name}} method
func (c *MessageSender) Send{{$name}}(msg model.{{$name}}) error {
    return c.send(msg)
}
{{- end}}